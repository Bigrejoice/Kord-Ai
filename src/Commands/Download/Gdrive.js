const a0_0x1c6356=a0_0x5737;(function(_0x5bb463,_0x22fdec){const _0x113ff1=a0_0x5737,_0x5bbefb=_0x5bb463();while(!![]){try{const _0x311ca8=parseInt(_0x113ff1(0x17f))/0x1*(parseInt(_0x113ff1(0x16a))/0x2)+-parseInt(_0x113ff1(0x175))/0x3+-parseInt(_0x113ff1(0x153))/0x4+parseInt(_0x113ff1(0x167))/0x5+parseInt(_0x113ff1(0x17a))/0x6+-parseInt(_0x113ff1(0x156))/0x7*(-parseInt(_0x113ff1(0x172))/0x8)+-parseInt(_0x113ff1(0x16c))/0x9*(-parseInt(_0x113ff1(0x17e))/0xa);if(_0x311ca8===_0x22fdec)break;else _0x5bbefb['push'](_0x5bbefb['shift']());}catch(_0x4cd0a3){_0x5bbefb['push'](_0x5bbefb['shift']());}}}(a0_0x5dc2,0x21740));const fetch=require(a0_0x1c6356(0x14d)),fs=require('fs')['promises'],fsSync=require('fs'),path=require(a0_0x1c6356(0x174)),archiver=require('archiver'),axios=require(a0_0x1c6356(0x187)),TEMP_DIR=path[a0_0x1c6356(0x180)](__dirname,a0_0x1c6356(0x155));function a0_0x5dc2(){const _0x534f8f=['test','332600thvIMr','unlink','path','344433kSfdoY','reply','Invalid\x20folder\x20URL','https://drive.google.com/uc?id=','fileName','359256xFodeJ','application/octet-stream','content-disposition','kord','1621630BDYDMR','11YzsYmp','join','Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/91.0.4472.124\x20Safari/537.36','&export=download&confirm=','data','get','/folders/','❌\x20Error:\x20','axios','Error\x20with\x20file\x20','❌\x20Please\x20provide\x20a\x20Google\x20Drive\x20URL.','node-fetch','Failed\x20to\x20get\x20download\x20info:\x20','key','content-type','downloadUrl','map','860236cOIJQo','📂\x20Found\x20','../tmp/','28GWljol','⏳\x20Downloading:\x20','https://drive.google.com/drive/folders/','sendMessage','length','mkdir','split','Download\x20files/folders\x20from\x20Google\x20Drive','pipe','&export=download','match','Download\x20failed:\x20','access','error','Folder\x20processing\x20failed:\x20','set-cookie','message','263690HgZvYS','📝\x20Processing\x20Google\x20Drive\x20link...','✅\x20Folder\x20download\x20completed!','4694WNAbGj','Unknown\x20error\x20occurred','9QfXnQP','✅\x20Sent:\x20','No\x20accessible\x20files\x20found','\x20files.\x20Starting\x20download...','push'];a0_0x5dc2=function(){return _0x534f8f;};return a0_0x5dc2();}module['exports']={'usage':['gdrive','googledrive'],'desc':a0_0x1c6356(0x15d),'commandType':'Download','isGroupOnly':![],'isAdminOnly':![],'isPrivateOnly':![],'emoji':'☁️','execute':handleDriveCommand};async function handleDriveCommand(_0x454a73,_0x2f5ed6,_0x185bce){const _0x1abef2=a0_0x1c6356;if(!_0x185bce[0x0])return await replyMessage(_0x2f5ed6,_0x1abef2(0x14c));const _0x3c01d3=_0x185bce[0x0];try{await replyMessage(_0x2f5ed6,_0x1abef2(0x168));if(!isValidDriveUrl(_0x3c01d3))return await replyMessage(_0x2f5ed6,'❌\x20Invalid\x20Google\x20Drive\x20URL.');_0x3c01d3['includes'](_0x1abef2(0x185))?await handleFolder(_0x3c01d3,_0x454a73,_0x2f5ed6):await handleFile(_0x3c01d3,_0x454a73,_0x2f5ed6);}catch(_0x514226){console[_0x1abef2(0x163)]('Drive\x20Download\x20Error:',_0x514226),await replyMessage(_0x2f5ed6,_0x1abef2(0x186)+(_0x514226[_0x1abef2(0x166)]||_0x1abef2(0x16b)));}}async function handleFolder(_0x48d7df,_0x452821,_0x2f387c){const _0x500fdc=a0_0x1c6356;try{const _0x54a3f4=await getFolderFiles(_0x48d7df);if(!_0x54a3f4['length'])throw new Error(_0x500fdc(0x16e));await replyMessage(_0x2f387c,_0x500fdc(0x154)+_0x54a3f4[_0x500fdc(0x15a)]+_0x500fdc(0x16f));for(const _0x7f9151 of _0x54a3f4){try{await downloadAndSendFile(_0x7f9151,_0x452821,_0x2f387c),await new Promise(_0x166cad=>setTimeout(_0x166cad,0x3e8));}catch(_0x5a12ed){console[_0x500fdc(0x163)](_0x500fdc(0x14b)+_0x7f9151+':',_0x5a12ed);}}await replyMessage(_0x2f387c,_0x500fdc(0x169));}catch(_0x26fdc0){throw new Error(_0x500fdc(0x164)+_0x26fdc0[_0x500fdc(0x166)]);}}async function getFolderFiles(_0x183f1a){const _0x15ddd0=a0_0x1c6356;try{const _0x13d46c=_0x183f1a['match'](/folders\/([^/?]+)/)?.[0x1];if(!_0x13d46c)throw new Error(_0x15ddd0(0x177));const _0x55e8cf=await axios[_0x15ddd0(0x184)](_0x15ddd0(0x158)+_0x13d46c,{'headers':{'User-Agent':_0x15ddd0(0x181)}}),_0x2c340c=[],_0x254014=_0x55e8cf['data'][_0x15ddd0(0x160)](/\/file\/d\/([^/"\s]+)/g)||[];for(const _0x3e58f2 of _0x254014){const _0x398228=_0x3e58f2[_0x15ddd0(0x15c)]('/')[0x3];_0x398228&&!_0x2c340c['includes'](_0x398228)&&_0x2c340c[_0x15ddd0(0x170)](_0x398228);}return _0x2c340c;}catch(_0xbc588a){throw new Error('Failed\x20to\x20get\x20folder\x20contents:\x20'+_0xbc588a[_0x15ddd0(0x166)]);}}function a0_0x5737(_0x3f0961,_0xb5d8d9){const _0x5dc2d4=a0_0x5dc2();return a0_0x5737=function(_0x57374b,_0x3dadbe){_0x57374b=_0x57374b-0x14b;let _0x1ccf75=_0x5dc2d4[_0x57374b];return _0x1ccf75;},a0_0x5737(_0x3f0961,_0xb5d8d9);}async function handleFile(_0x2e8a75,_0x4ca3b6,_0x145047){const _0x2034ba=extractFileId(_0x2e8a75);if(!_0x2034ba)throw new Error('Invalid\x20file\x20URL');await downloadAndSendFile(_0x2034ba,_0x4ca3b6,_0x145047);}async function downloadAndSendFile(_0x409ae3,_0x27ed92,_0x306b9b){const _0x313691=a0_0x1c6356;try{const _0x1aa01c=await getDownloadInfo(_0x409ae3);await replyMessage(_0x306b9b,_0x313691(0x157)+_0x1aa01c[_0x313691(0x179)]);const _0x766b1e=path[_0x313691(0x180)](TEMP_DIR,_0x1aa01c[_0x313691(0x179)]);await downloadFile(_0x1aa01c[_0x313691(0x151)],_0x766b1e),await _0x27ed92[_0x313691(0x159)](_0x306b9b[_0x313691(0x14f)]['remoteJid'],{'document':fsSync['createReadStream'](_0x766b1e),'fileName':_0x1aa01c['fileName'],'mimetype':_0x1aa01c['mimeType']||_0x313691(0x17b)},{'quoted':_0x306b9b}),await fs[_0x313691(0x173)](_0x766b1e),await replyMessage(_0x306b9b,_0x313691(0x16d)+_0x1aa01c[_0x313691(0x179)]);}catch(_0x22a1ce){throw new Error(_0x313691(0x161)+_0x22a1ce['message']);}}async function getDownloadInfo(_0x19142f){const _0xa38584=a0_0x1c6356;try{const _0x4314cf=await axios['get'](_0xa38584(0x178)+_0x19142f+_0xa38584(0x15f),{'headers':{'User-Agent':_0xa38584(0x181)},'maxRedirects':0x0,'validateStatus':_0x143d93=>_0x143d93>=0xc8&&_0x143d93<0x190}),_0x3cf92a=_0x4314cf[_0xa38584(0x183)][_0xa38584(0x160)](/confirm=([^&]+)/)?.[0x1],_0x3f1196=_0x4314cf['headers'][_0xa38584(0x165)]?.[_0xa38584(0x152)](_0x1c0c75=>_0x1c0c75['split'](';')[0x0])['join'](';\x20');let _0x33f807,_0x1f8370=_0x19142f,_0x3f5b85=_0xa38584(0x17b);_0x3cf92a?_0x33f807=_0xa38584(0x178)+_0x19142f+_0xa38584(0x182)+_0x3cf92a:_0x33f807='https://drive.google.com/uc?id='+_0x19142f+'&export=download';const _0x2fbc11=_0x4314cf['headers'][_0xa38584(0x17c)];if(_0x2fbc11){const _0x11f995=_0x2fbc11['match'](/filename\*?=['"]?(?:UTF-\d['"]*)?([^;\r\n"']*)['"]?;?/i);_0x11f995&&(_0x1f8370=decodeURIComponent(_0x11f995[0x1]));}const _0x29353b=_0x4314cf['headers'][_0xa38584(0x150)];return _0x29353b&&(_0x3f5b85=_0x29353b),{'downloadUrl':_0x33f807,'fileName':_0x1f8370,'mimeType':_0x3f5b85,'cookies':_0x3f1196};}catch(_0x574ff1){throw new Error(_0xa38584(0x14e)+_0x574ff1[_0xa38584(0x166)]);}}async function downloadFile(_0x43e6af,_0x24a655){const _0x428fcc=a0_0x1c6356,_0x27fd49=await axios({'method':'GET','url':_0x43e6af,'responseType':'stream','headers':{'User-Agent':_0x428fcc(0x181)}}),_0x46c746=fsSync['createWriteStream'](_0x24a655);return _0x27fd49[_0x428fcc(0x183)][_0x428fcc(0x15e)](_0x46c746),new Promise((_0x14f055,_0xe7bf70)=>{_0x46c746['on']('finish',_0x14f055),_0x46c746['on']('error',_0xe7bf70);});}function isValidDriveUrl(_0x2d68a5){const _0x1d6ef7=a0_0x1c6356;return/drive\.google\.com\/(file\/d\/|drive\/folders\/)/i[_0x1d6ef7(0x171)](_0x2d68a5);}function extractFileId(_0x56634d){const _0x57a840=a0_0x1c6356,_0x418de4=_0x56634d[_0x57a840(0x160)](/\/file\/d\/([^/]+)/);return _0x418de4?_0x418de4[0x1]:null;}async function replyMessage(_0x5392e0,_0x339836){const _0x49b5d7=a0_0x1c6356;return await global[_0x49b5d7(0x17d)][_0x49b5d7(0x176)](_0x5392e0,_0x339836);}((async()=>{const _0x30c92b=a0_0x1c6356;try{await fs[_0x30c92b(0x162)](TEMP_DIR);}catch{await fs[_0x30c92b(0x15b)](TEMP_DIR,{'recursive':!![]});}})());